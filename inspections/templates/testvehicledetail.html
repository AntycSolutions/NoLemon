{% extends "base.html" %}

{% block title %} - Vehicle Detail{% endblock %}

{% block content %}

{% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <li>{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}

{% if vehicle %}
    <p>VIN: {{ vehicle.vin }}</p>
    <p>Owner: <a href="{% url 'seller_detail' vehicle.owner.pk %}">{{ vehicle.owner }}</a></p>
    <p>Make: {{ vehicle.make }}</p>
    <p>Model: {{ vehicle.model }}</p>
    <p>Year: {{ vehicle.year }}</p>
    {% if request_inspection %}
        Your request for an inspection on {{ request_inspection.request_date }} is pending.
        <a href="{% url 'print_request_inspection' vehicle.vin request_inspection.pk %}">Print requested inspection</a>
    {% endif %}
    {% if vehicle.owner.email == user.email %}
    	<form method="get" action="{% url 'pay_for_inspection' %}">
	    	{% csrf_token %}
    		<input type="hidden" name="vehicle" value="{{ vehicle.vin }}">
    		<input type="submit" value="Request New Inspection">
    	</form>
    {% else %}
        {% if not request_inspection %}
            <p>Contact the seller about requesting an inspection.</p>
        {% endif %}
    {% endif %}
    <h1>Inspections</h1>
    {% for inspection in vehicle.inspection_set.all %}
        <div>
        <p>Vehicle: <a href="{% url 'vehicle_detail' inspection.vehicle.vin %}">{{ inspection.vehicle }}</a></p>
        <p>Date: {{ inspection.date }}</p>
        <p>Comments: {{ inspection.comments }}</p>
        <p>Views: {{ inspection.views }}</p>
        <p>Mechanic: <a href="{% url 'mechanic_detail' inspection.mechanic.pk %}">{{ inspection.mechanic }}</a></p>
        <hr>
        </div>
    {% empty %}
        <p>There are no inspections for this vehicle.</p>
    {% endfor %}
{% else %}
    <p>You shouldn't be seeing this</p>
{% endif %}

{% endblock %}
